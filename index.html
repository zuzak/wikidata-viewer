<!DOCTYPE html>
<html>
<head>
    <title>Wikidata</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <style>
        body {
            background-color: #ccc;
            color:#333;
            font-family:sans-serif;
            text-align:center;
        }
        input {
            border: 2px solid #aaa;
            font-size:2em;
            width:100%;
        }
        .info {
            margin:2em;
        }
        .image {
            max-width:400px;
            max-height:400px;
            margin:auto;
            display:block;
        }
    </style>
    <script>
      $(document).ready(function(){
        $('input').keypress(function(e){
          if(e.keyCode == 13){
            $('.info').fadeOut()
            var searchTerm = $('input').val()
            searchTerm = encodeURI(searchTerm)
            $.getJSON('data/' + searchTerm, function(data){
              if(data.descriptions){
                $('.desc').text(data.descriptions.en.value)
              } else {
                $('.desc').text('')
              }
              renderImg("P18",".image",data)
              renderImg("P51",".sound",data)
              /*
              $('audio').each(function(){
                  $(this).get(0).stop()
              })*/
              if(getData(data,"P51")){
                  var sound = '<audio src="img/' + getData(data,"P51")
                  sound += '" autoplay>'
                  $('body').append(sound)
              }
              $('.info').fadeIn()
            }).fail(function(){
              console.log('fucked')
            })
          }
        })
      })
      function getData(data,property){
          return data.claims[property][0].mainsnak.datavalue.value
      }
      function renderImg(property, element, data){
          if(data.claims[property]){
              var value = getData(data,property)
              $(element).attr('src','img/' + value)
          } else {
              $(element).attr('src','http://i.imgur.com/pRyNqK9.png')
          }
      }
      function renderTxt(property, element, data){
          if(data.claims[property]){
              var value = getData(data,property)
              $(element).text(value)
          } else {
              $(element).text("")
          }
      }
    </script>
</head>
<body>
    <h1>Wikidata viewer</h1>
    <input placeholder="Las Vegas" type="text" />
    <div class="info">
        <img src="http://i.imgur.com/pRyNqK9.png" class="image" />
        <span class="desc"></span>
        <audio src="" autoplay>
    </div>
</body>

